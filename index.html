<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üè∏ Smash Clash - Viewer</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="top-header">
  <div class="banner-container">
    <img class="main-banner" src="your-banner.png" alt="Smash Clash Logo" />
    <div class="event-title">üè∏ Smash Clash ‚Äì Viewer</div>
    <div class="sponsor-text">Sponsored by <strong>PC REALTY</strong></div>
  </div>

  <div class="controls">
    <button id="toggleDarkMode">üåô Toggle Dark Mode</button>
  </div>
</header>


  <main class="content">
    <div id="captainDetails"></div>
    <div id="playerEntry"></div>

    <div class="tabs">
      <button class="tab-button active" data-tab="doublesTab">Doubles</button>
      <button class="tab-button" data-tab="singlesTab">Singles</button>
    </div>

    <div class="tab-content active" id="doublesTab">
      <div id="doublesStats"></div>
      <div id="teamStatsDoubles"></div>
      <div id="playerStatsDoubles"></div>
    </div>

    <div class="tab-content" id="singlesTab">
      <div id="singlesStats"></div>
      <div id="teamStatsSingles"></div>
      <div id="playerStatsSingles"></div>
    </div>
  </main>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, get, child } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDyn7Khn-nLY_9w9hjx1FExQWy4AntHxjU",
      authDomain: "smash-clash-data.firebaseapp.com",
      projectId: "smash-clash-data",
      databaseURL: "https://smash-clash-data-default-rtdb.firebaseio.com",
      storageBucket: "smash-clash-data.appspot.com",
      messagingSenderId: "479731411827",
      appId: "1:479731411827:web:d2b84774f634a4c702b306",
      measurementId: "G-SSMP0F2K39"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const dbRef = ref(db);

    const teams = [
      { name: "Red Rhinos", color: "red", players: [], captain: "" },
      { name: "Orange Owls", color: "orange", players: [], captain: "" },
      { name: "Black Bears", color: "black", players: [], captain: "" },
      { name: "Yellow Yaks", color: "gold", players: [], captain: "" },
      { name: "Purple Pythons", color: "purple", players: [], captain: "" },
      { name: "Pink Pumas", color: "pink", players: [], captain: "" }
    ];

    const stats = {
      doubles: [], singles: [],
      teamDoubles: {}, teamSingles: {},
      playerDoubles: {}, playerSingles: {}
    };

    document.addEventListener("DOMContentLoaded", () => {
      const captainDiv = document.getElementById("captainDetails");
      const playerDiv = document.getElementById("playerEntry");

      function renderCaptains() {
        captainDiv.innerHTML = "<h3>Captains</h3>";
        teams.forEach((team) => {
          const para = document.createElement("p");
          para.innerHTML = `<span style="color:${team.color}">${team.name} Captain:</span> ${team.captain || "‚Äî"}`;
          captainDiv.appendChild(para);
        });
      }

      function renderPlayers() {
        playerDiv.innerHTML = "<h3>Players</h3>";
        teams.forEach((team) => {
          const div = document.createElement("div");
          div.innerHTML = `<h4 style="color:${team.color}">${team.name}</h4><ul>${
            team.players.map(p => `<li>${p}</li>`).join("")
          }</ul>`;
          playerDiv.appendChild(div);
        });
      }

      function buildStatTable(obj, label) {
        const sorted = Object.entries(obj).sort((a, b) => b[1].points - a[1].points);
        return `<h4>${label}</h4><table>
          <tr><th>Name</th><th>Wins</th><th>Losses</th><th>Points</th></tr>` +
          sorted.map(([name, val]) =>
            `<tr><td>${name}</td><td>${val.wins}</td><td>${val.losses}</td><td>${val.points}</td></tr>`
          ).join("") + `</table>`;
      }

      function buildPlayerTable(obj, label) {
        const sorted = Object.entries(obj).sort((a, b) => b[1].points - a[1].points);
        return `<h4>${label}</h4><table>
          <tr><th>Player</th><th>Matches</th><th>Wins</th><th>Losses</th><th>Points</th></tr>` +
          sorted.map(([name, val]) =>
            `<tr><td>${name}</td><td>${val.matches || 0}</td><td>${val.wins}</td><td>${val.losses}</td><td>${val.points}</td></tr>`
          ).join("") + `</table>`;
      }

      function buildMatchTable(data, isDoubles) {
        return `<table><tr><th>Team A</th><th>Pair A</th><th>Team B</th><th>Pair B</th><th>Winner</th><th>Type</th><th>Points</th></tr>` +
          data.map(d => `<tr>
            <td>${d.teamA}</td>
            <td>${d.a1}${isDoubles && d.a2 ? " & " + d.a2 : ""}</td>
            <td>${d.teamB}</td>
            <td>${d.b1}${isDoubles && d.b2 ? " & " + d.b2 : ""}</td>
            <td>${d.win}</td>
            <td>${d.isTrump ? "Trump Win" : d.isTrumpLost ? "Trump Loss" : "Normal"}</td>
            <td>${d.point}</td>
          </tr>`).join("") + "</table>";
      }

      function renderStats() {
        document.getElementById("doublesStats").innerHTML = buildMatchTable(stats.doubles, true);
        document.getElementById("singlesStats").innerHTML = buildMatchTable(stats.singles, false);
        document.getElementById("teamStatsDoubles").innerHTML = buildStatTable(stats.teamDoubles, "Team Doubles");
        document.getElementById("teamStatsSingles").innerHTML = buildStatTable(stats.teamSingles, "Team Singles");
        document.getElementById("playerStatsDoubles").innerHTML = buildPlayerTable(stats.playerDoubles, "Player Doubles");
        document.getElementById("playerStatsSingles").innerHTML = buildPlayerTable(stats.playerSingles, "Player Singles");
      }

      function loadFromFirebase() {
        get(child(dbRef, "tournamentData")).then(snapshot => {
          if (snapshot.exists()) {
            const data = snapshot.val();
            if (data.teams) {
              data.teams.forEach((t, i) => {
                teams[i].captain = t.captain;
                teams[i].players = t.players;
              });
              renderCaptains();
              renderPlayers();
            }
            if (data.stats) {
              Object.assign(stats, data.stats);
              renderStats();
            }
          }
        });
      }

      document.querySelectorAll(".tab-button").forEach(btn => {
        btn.addEventListener("click", () => {
          document.querySelectorAll(".tab-button").forEach(b => b.classList.remove("active"));
          document.querySelectorAll(".tab-content").forEach(tab => tab.classList.remove("active"));
          btn.classList.add("active");
          document.getElementById(btn.dataset.tab).classList.add("active");
        });
      });

      document.getElementById("toggleDarkMode").onclick = () =>
        document.body.classList.toggle("dark-mode");

      loadFromFirebase();
    });
  </script>
</body>
</html>
